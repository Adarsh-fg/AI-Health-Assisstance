{% extends "base.html" %}

{% block title %}BMI Calculator{% endblock %}

{% block content %}
<div class="bmi-container">
    <h2>ðŸ§®BMI Calculator</h2>
    <p>Calculate your BMI and get personalized health advice</p>
    
    <form id="bmiForm" class="mt-4">
        <div class="form-group">
            <label for="height">Height (cm)</label>
            <input type="number" id="height" name="height" required min="100" max="250">
        </div>
        
        <div class="form-group">
            <label for="weight">Weight (kg)</label>
            <input type="number" id="weight" name="weight" required min="20" max="300">
        </div>
        
        <div class="form-group">
            <label for="age">Age</label>
            <input type="number" id="age" name="age" required min="1" max="120">
        </div>
        
        <div class="form-group">
            <label for="gender">Gender</label>
            <select id="gender" name="gender" required>
                <option value="">Select Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>
        </div>
        
        <button type="submit" class="btn">Calculate BMI</button>
    </form>
</div>

<div id="bmiResult" class="card" style="display: none;">
    <h3>Your BMI Results</h3>
    <div id="bmiValue" class="mb-4"></div>
    <div id="bmiCategory" class="mb-4"></div>
    <div id="healthAdvice" class="mb-4"></div>
</div>

<style>
    /* Add some basic styling to our BMI calculator */
    .bmi-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 2rem;
        border-radius: 16px;
        border: 1px solid var(--border-color);
    }
    .bmi-container h2 {
    color: var(--primary-dark);
    font-size: 2rem;
    margin-bottom: 0.5rem;
    text-align: center;
  }

  .bmi-container p {
    text-align: center;
    color: var(--slate-blue);
    margin-bottom: 2rem;}


    .bmi-category {
        padding: 1rem;
        border-radius: 8px;
        margin: 1rem 0;
    }
    
    .underweight {
        background-color: #fff3e0;
        color: #ef6c00;
    }
    
    .normal {
        background-color: #e8f5e9;
        color: #2e7d32;
    }
    
    .overweight {
        background-color: #fff3e0;
        color: #ef6c00;
    }
    
    .obese {
        background-color: #ffebee;
        color: #c62828;
    }
</style>

<script>
document.getElementById('bmiForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = {
        height: document.getElementById('height').value,
        weight: document.getElementById('weight').value,
        age: document.getElementById('age').value,
        gender: document.getElementById('gender').value
    };
    
    try {
        const response = await fetch('/calculate-bmi', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (data.success) {
            const resultDiv = document.getElementById('bmiResult');
            const bmiValue = document.getElementById('bmiValue');
            const bmiCategory = document.getElementById('bmiCategory');
            const healthAdvice = document.getElementById('healthAdvice');
            
            bmiValue.innerHTML = `<h4>Your BMI: ${data.bmi.toFixed(1)}</h4>`;
            
            let categoryClass = '';
            switch(data.category) {
                case 'Underweight':
                    categoryClass = 'underweight';
                    break;
                case 'Normal weight':
                    categoryClass = 'normal';
                    break;
                case 'Overweight':
                    categoryClass = 'overweight';
                    break;
                case 'Obese':
                    categoryClass = 'obese';
                    break;
            }
            
            bmiCategory.innerHTML = `
                <div class="bmi-category ${categoryClass}">
                    <h4>Category: ${data.category}</h4>
                </div>
            `;
            
            healthAdvice.innerHTML = `
                <h4>Personalized Health Advice</h4>
                <div class="health-advice-content">
                    ${data.advice}
                </div>
            `;
            
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        } else {
            alert('Error calculating BMI. Please try again.');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Error calculating BMI. Please try again.');
    }
});
</script>
{% endblock %} 